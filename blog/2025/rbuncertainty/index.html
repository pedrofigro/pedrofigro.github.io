<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Uncertainties in RB | Pedro Figueroa-Romero </title> <meta name="author" content="Pedro Figueroa-Romero"> <meta name="description" content="Cause if you like it, then you shoulda put uncertainties on it"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%8C%84%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://pedrofigro.github.io/blog/2025/rbuncertainty/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Pedro</span> Figueroa-Romero </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <p>During my BSc in Physics (<em>Licenciatura en FÃ­sica</em>), I was always frustrated by the experimental coursesâ€”not because of the experiments themselves, but because of the analysis afterwards. Worst of all was dealing with statistics and numerical uncertainties! Ironically, those very tools later became central to my career.</p> <p>Fast forward to the end of my PhD: I entered the quantum computing world through the technique now widely known as <a href="https://en.wikipedia.org/wiki/Randomized_benchmarking" rel="external nofollow noopener" target="_blank">Randomised Benchmarking</a>, or simply RB. Within the quantum computing communityâ€”hardware engineers and theorists alikeâ€”RB is regarded as <em>the</em> standard method for estimating gate fidelities. Of course, there are other approaches, but RB remains the primary tool for this purpose.</p> <p>For those of us working more deeply in the <a href="https://arxiv.org/abs/2503.16383" rel="external nofollow noopener" target="_blank">QCVV</a> sub-field, RB is better understood as a broad framework that has spawned numerous variants and related techniques. The boundaries between them are often blurry. For example, the <em>traditional</em> single-qubit and two-qubit Clifford RB can be seen as a special case of the <a href="https://www.nature.com/articles/s41467-023-39382-9" rel="external nofollow noopener" target="_blank">Gate Set Shadow framework</a>. Historically, RB also helped popularise the concept of <a href="https://en.wikipedia.org/wiki/Quantum_t-design" rel="external nofollow noopener" target="_blank">unitary <em>t</em>-designs</a>â€”ensembles of gates that mimic the uniform distribution over the unitary group up to the <em>t</em><sup>th</sup> statistical moment. This unitary design concept is now essential for many randomised protocols to be practical.</p> <p>Within the broader community, however, RB is often associated with some <em>folk claims</em>. Two common ones are:</p> <ul> <li>RB always produces an exponential decay from which fidelity can be extracted.</li> <li>The Clifford group is always a 2-design.</li> </ul> <p>Both claims are conditional. The first depends on whether the average noise <a href="https://arxiv.org/abs/1109.6887" rel="external nofollow noopener" target="_blank">approximately satisfies certain assumptions</a>. The second depends on the <a href="https://arxiv.org/abs/2108.04200" rel="external nofollow noopener" target="_blank">dimensionality of the group</a>.</p> <hr> <h2 id="reading-between-the-lines-of-rb-data">Reading Between the Lines of RB Data</h2> <p>Beyond these headline results, RB outputs contain subtler information about the average noise.</p> <ul> <li> <strong>Exponential decay of the averages:</strong> If the average survival probabilities at chosen sequence lengths do not follow an exponential decay, one should proceed with caution. Questions arise: <em>How many outliers are there? Are enough sequence lengths sampled? Should more circuits be run? Is there a quantitative measure of the deviations?</em> </li> <li> <strong>Distribution of survival probabilities:</strong> Even when averages fit an exponential decay, the distribution of individual survival probabilities at fixed sequence lengths can reveal the nature of the noise. Error bars (often the <a href="https://en.wikipedia.org/wiki/Standard_error" rel="external nofollow noopener" target="_blank">standard error</a> of the mean) are useful, but they may conceal skewness or outliers.</li> </ul> <p>The key point is that <em>minimally processed data</em>â€”individual survival probabilitiesâ€”can already indicate whether something could be more seriously wrong (non-exponential behavior, skewed distributions, big outliers). Moreover, the variance of these probabilities at each sequence length is related to the purity of the outputs, which in turn provides qualitative insight into the <a href="https://arxiv.org/abs/1503.07865" rel="external nofollow noopener" target="_blank"><em>unitarity</em></a>â€”a measure of how unitary the noise channel is.</p> <p>This matters because it affects how much confidence one can place in the reported fidelity. Importantly, Iâ€™m not referring to the uncertainty in the final fitted number (which depends on the fitting procedure and its assumptions). Rather, I mean the uncertainty inherent in each average point at every chosen sequence length.</p> <hr> <h2 id="examples-urb-and-iirb">Examples: URB and IIRB</h2> <p>Two protocols illustrate these ideas clearly: <strong>Unitarity RB (URB)</strong> and <strong>Iterative Interleaved RB (IIRB).</strong></p> <h3 id="urb">URB</h3> <p>URB estimates how unitary the noise is, with a fidelity-like measure, on average. It modifies standard Clifford RB by requiring measurements in all Pauli bases (effectively tomography for each circuit sample). Introduced in <a href="https://arxiv.org/abs/1503.07865" rel="external nofollow noopener" target="_blank">arXiv:1503.07865</a>, URB also formalised the definition of <em>unitarity</em>. In our own work (<a href="arXiv:2409.02110">arXiv:2409.02110</a>), we extended URB and derived an upper bound for the unitarity of Pauli noise in terms of fidelity. Depolarizing noise achieves the lowest possible unitarity, while purely unitary channels have unitarity 1 - we <em>bridged</em> that gap so that you can tell whether the unitarity is close to that of purely stochastic noise (between upper-bound and depolarizing) or it certainly has a coherent contribution (between upper-bound and 1).</p> <p>Running Clifford RB alongside URB highlights differences: two noise models with the same fidelityâ€”one dominated by stochastic errors, the other by coherent errorsâ€”produce starkly different decays. The coherent case exhibits higher unitarity.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/purity_stoch.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/purity_coherent.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h3 id="iirb">IIRB</h3> <p>IIRB tweaks Interleaved RB by interleaving the gate of interest multiple times and examining the estimated fidelities. First proposed in <a href="https://arxiv.org/abs/1504.06597" rel="external nofollow noopener" target="_blank">arXiv:1504.06597</a>, it was later used in <a href="https://arxiv.org/abs/2508.16437" rel="external nofollow noopener" target="_blank">IQMâ€™s demonstration</a> of native two-qubit gates with fidelities above 99.9%.</p> <p>The principle is simple: fidelity should decay linearly with the number of interleavings, equal to the slope of decay. If it decays faster, errors are accumulating more severely than expected under stochastic noise. Simulation with models as above for URB show a clear difference between stochastic and coherent noise.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/iirb_stochastic.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/iirb_coherent.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/iirb_slopes.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> &lt;/div --- ## Why Coherence Matters Ironically, when survival probability distributions are presented, they often resemble the coherent case. This is significant because coherence in noise impacts: 1. **Fault-tolerance thresholds** 2. **Error accumulation over time** For deeper discussion on these, see [arXiv:2207.08786](https://arxiv.org/abs/2207.08786) and this [Qiskit seminar](https://www.youtube.com/live/0TxQF1VuBqY?si=O9x4IfECtzNEvNkW). Ironically enough, when people actually present the distribution of survival probabilities in the decays, often they look more like the coherent case. I often try to emphasise that reported fidelity is *not a good quality metric*, or not a sufficient one, at least in this sense, since I often get the impression of "fidelity" being another folk term within the community. To be fair, it is a really good figure of merit in the sense that it is the quality metric that we can estimate, at least approximately and with relative ease ðŸ˜… </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> Â© Copyright 2025 Pedro Figueroa-Romero. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: December 05, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> </body> </html>